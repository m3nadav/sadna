================================================================================
NEURAL NETWORK TRAINING (MLP on Engineered Features)
================================================================================
Device: cpu
Batch size: 128
Epochs: 100
================================================================================

[1/5] Loading data...
✓ Loaded: 574,945 rows

[2/5] Extracting features...
  Train set...
Processing 6520 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
  Processed 1700 sequences...
  Processed 1800 sequences...
  Processed 1900 sequences...
  Processed 2000 sequences...
  Processed 2100 sequences...
  Processed 2200 sequences...
  Processed 2300 sequences...
  Processed 2400 sequences...
  Processed 2500 sequences...
  Processed 2600 sequences...
  Processed 2700 sequences...
  Processed 2800 sequences...
  Processed 2900 sequences...
  Processed 3000 sequences...
  Processed 3100 sequences...
  Processed 3200 sequences...
  Processed 3300 sequences...
  Processed 3400 sequences...
  Processed 3500 sequences...
  Processed 3600 sequences...
  Processed 3700 sequences...
  Processed 3800 sequences...
  Processed 3900 sequences...
  Processed 4000 sequences...
  Processed 4100 sequences...
  Processed 4200 sequences...
  Processed 4300 sequences...
  Processed 4400 sequences...
  Processed 4500 sequences...
  Processed 4600 sequences...
  Processed 4700 sequences...
  Processed 4800 sequences...
  Processed 4900 sequences...
  Processed 5000 sequences...
  Processed 5100 sequences...
  Processed 5200 sequences...
  Processed 5300 sequences...
  Processed 5400 sequences...
  Processed 5500 sequences...
  Processed 5600 sequences...
  Processed 5700 sequences...
  Processed 5800 sequences...
  Processed 5900 sequences...
  Processed 6000 sequences...
  Processed 6100 sequences...
  Processed 6200 sequences...
  Processed 6300 sequences...
  Processed 6400 sequences...
  Processed 6500 sequences...
✓ Feature extraction complete: (6520, 86)
  Total features: 85
Processing 6520 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
  Processed 1700 sequences...
  Processed 1800 sequences...
  Processed 1900 sequences...
  Processed 2000 sequences...
  Processed 2100 sequences...
  Processed 2200 sequences...
  Processed 2300 sequences...
  Processed 2400 sequences...
  Processed 2500 sequences...
  Processed 2600 sequences...
  Processed 2700 sequences...
  Processed 2800 sequences...
  Processed 2900 sequences...
  Processed 3000 sequences...
  Processed 3100 sequences...
  Processed 3200 sequences...
  Processed 3300 sequences...
  Processed 3400 sequences...
  Processed 3500 sequences...
  Processed 3600 sequences...
  Processed 3700 sequences...
  Processed 3800 sequences...
  Processed 3900 sequences...
  Processed 4000 sequences...
  Processed 4100 sequences...
  Processed 4200 sequences...
  Processed 4300 sequences...
  Processed 4400 sequences...
  Processed 4500 sequences...
  Processed 4600 sequences...
  Processed 4700 sequences...
  Processed 4800 sequences...
  Processed 4900 sequences...
  Processed 5000 sequences...
  Processed 5100 sequences...
  Processed 5200 sequences...
  Processed 5300 sequences...
  Processed 5400 sequences...
  Processed 5500 sequences...
  Processed 5600 sequences...
  Processed 5700 sequences...
  Processed 5800 sequences...
  Processed 5900 sequences...
  Processed 6000 sequences...
  Processed 6100 sequences...
  Processed 6200 sequences...
  Processed 6300 sequences...
  Processed 6400 sequences...
  Processed 6500 sequences...
✓ Feature extraction complete: (6520, 161)
  Total features: 160
  Validation set...
Processing 1631 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
✓ Feature extraction complete: (1631, 86)
  Total features: 85
Processing 1631 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
✓ Feature extraction complete: (1631, 161)
  Total features: 160
✓ Features extracted: IMU=83, Full=158

[3/5] Preparing datasets...
✓ Train: 6,520 sequences, Val: 1,631 sequences

[4/5] Training models...

[4.1] IMU-only Neural Network

Training nn_imu...
  Epoch   1/100: Loss=nan/nan Score=0.3938 (Bin=0.7714, Mac=0.0162)
  Epoch  10/100: Loss=nan/nan Score=0.3938 (Bin=0.7714, Mac=0.0162)
  Early stopping at epoch 16 (best score: 0.3938)

[4.2] Full Sensor Neural Network

Training nn_full...
  Epoch   1/100: Loss=nan/nan Score=0.3938 (Bin=0.7714, Mac=0.0162)
  Epoch  10/100: Loss=nan/nan Score=0.3938 (Bin=0.7714, Mac=0.0162)
  Early stopping at epoch 16 (best score: 0.3938)

================================================================================
[5/5] FINAL EVALUATION
================================================================================

IMU-only Model:
  Competition Score: 0.3938
  Binary F1: 0.7714
  Macro F1: 0.0162

Full Sensor Model:
  Competition Score: 0.3938
  Binary F1: 0.7714
  Macro F1: 0.0162

================================================================================
COMPARISON: XGBoost vs Neural Network
================================================================================
Model                | XGBoost    | Neural Net | Difference
--------------------------------------------------------------------------------
IMU-only             | 0.6864     | 0.3938     | -0.2926
Full Sensor          | 0.7838     | 0.3938     | -0.3900
Overall (50/50)      | 0.7351     | 0.3938     | -0.3413
================================================================================

⚠️  XGBoost still better - stick with tree-based models

✓ Models saved:
  - models/nn_imu.pth
  - models/nn_full.pth
  - models/nn_metadata.pkl
