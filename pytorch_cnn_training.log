================================================================================
PYTORCH 1D CNN TRAINING
================================================================================
Device: cpu
Batch size: 64
Epochs: 50
================================================================================

[1/6] Loading data...
✓ Loaded: 574,945 rows

[2/6] Using pre-extracted features from XGBoost...
✓ Using XGBoost engineered features (much faster than raw sequences!)
  IMU features: 83 features
  Full features: 158 features

[3/6] Extracting features...
  Processing train...
Processing 6520 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
  Processed 1700 sequences...
  Processed 1800 sequences...
  Processed 1900 sequences...
  Processed 2000 sequences...
  Processed 2100 sequences...
  Processed 2200 sequences...
  Processed 2300 sequences...
  Processed 2400 sequences...
  Processed 2500 sequences...
  Processed 2600 sequences...
  Processed 2700 sequences...
  Processed 2800 sequences...
  Processed 2900 sequences...
  Processed 3000 sequences...
  Processed 3100 sequences...
  Processed 3200 sequences...
  Processed 3300 sequences...
  Processed 3400 sequences...
  Processed 3500 sequences...
  Processed 3600 sequences...
  Processed 3700 sequences...
  Processed 3800 sequences...
  Processed 3900 sequences...
  Processed 4000 sequences...
  Processed 4100 sequences...
  Processed 4200 sequences...
  Processed 4300 sequences...
  Processed 4400 sequences...
  Processed 4500 sequences...
  Processed 4600 sequences...
  Processed 4700 sequences...
  Processed 4800 sequences...
  Processed 4900 sequences...
  Processed 5000 sequences...
  Processed 5100 sequences...
  Processed 5200 sequences...
  Processed 5300 sequences...
  Processed 5400 sequences...
  Processed 5500 sequences...
  Processed 5600 sequences...
  Processed 5700 sequences...
  Processed 5800 sequences...
  Processed 5900 sequences...
  Processed 6000 sequences...
  Processed 6100 sequences...
  Processed 6200 sequences...
  Processed 6300 sequences...
  Processed 6400 sequences...
  Processed 6500 sequences...
✓ Feature extraction complete: (6520, 86)
  Total features: 85
Processing 6520 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
  Processed 1700 sequences...
  Processed 1800 sequences...
  Processed 1900 sequences...
  Processed 2000 sequences...
  Processed 2100 sequences...
  Processed 2200 sequences...
  Processed 2300 sequences...
  Processed 2400 sequences...
  Processed 2500 sequences...
  Processed 2600 sequences...
  Processed 2700 sequences...
  Processed 2800 sequences...
  Processed 2900 sequences...
  Processed 3000 sequences...
  Processed 3100 sequences...
  Processed 3200 sequences...
  Processed 3300 sequences...
  Processed 3400 sequences...
  Processed 3500 sequences...
  Processed 3600 sequences...
  Processed 3700 sequences...
  Processed 3800 sequences...
  Processed 3900 sequences...
  Processed 4000 sequences...
  Processed 4100 sequences...
  Processed 4200 sequences...
  Processed 4300 sequences...
  Processed 4400 sequences...
  Processed 4500 sequences...
  Processed 4600 sequences...
  Processed 4700 sequences...
  Processed 4800 sequences...
  Processed 4900 sequences...
  Processed 5000 sequences...
  Processed 5100 sequences...
  Processed 5200 sequences...
  Processed 5300 sequences...
  Processed 5400 sequences...
  Processed 5500 sequences...
  Processed 5600 sequences...
  Processed 5700 sequences...
  Processed 5800 sequences...
  Processed 5900 sequences...
  Processed 6000 sequences...
  Processed 6100 sequences...
  Processed 6200 sequences...
  Processed 6300 sequences...
  Processed 6400 sequences...
  Processed 6500 sequences...
✓ Feature extraction complete: (6520, 161)
  Total features: 160
  Processing val...
Processing 1631 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
✓ Feature extraction complete: (1631, 86)
  Total features: 85
Processing 1631 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
✓ Feature extraction complete: (1631, 161)
  Total features: 160

[4/6] Preparing datasets...
✓ Created datasets
  Train: 6,520 sequences
  Val: 1,631 sequences

[5/6] Training models...

[5.1] Training IMU-only model...
Traceback (most recent call last):
  File "/Users/nadav/code/openu/sadna/project/train_pytorch_cnn.py", line 390, in <module>
    main()
  File "/Users/nadav/code/openu/sadna/project/train_pytorch_cnn.py", line 342, in main
    model_imu, score_imu = train_model(
                           ^^^^^^^^^^^^
  File "/Users/nadav/code/openu/sadna/project/train_pytorch_cnn.py", line 165, in train_model
    outputs = model(X_batch)
              ^^^^^^^^^^^^^^
  File "/Users/nadav/.pyenv/versions/3.11.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nadav/.pyenv/versions/3.11.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nadav/code/openu/sadna/project/train_pytorch_cnn.py", line 103, in forward
    x = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/Users/nadav/.pyenv/versions/3.11.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nadav/.pyenv/versions/3.11.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nadav/.pyenv/versions/3.11.11/lib/python3.11/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/nadav/.pyenv/versions/3.11.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nadav/.pyenv/versions/3.11.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nadav/.pyenv/versions/3.11.11/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 134, in forward
    return F.max_pool1d(
           ^^^^^^^^^^^^^
  File "/Users/nadav/.pyenv/versions/3.11.11/lib/python3.11/site-packages/torch/_jit_internal.py", line 622, in fn
    return if_false(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nadav/.pyenv/versions/3.11.11/lib/python3.11/site-packages/torch/nn/functional.py", line 740, in _max_pool1d
    return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: max_pool1d() Invalid computed output size: 0
