

================================================================================
BASELINE MODEL TRAINING: XGBoost with Dual Strategy
================================================================================
Random Seed: 42
Validation Size: 20%
================================================================================
================================================================================
STEP 1: LOADING DATA
================================================================================
‚úì Loaded training data: 574,945 rows √ó 341 columns
  Unique sequences: 8,151
  Unique subjects: 81
  Gesture classes: 18

================================================================================
STEP 2: CREATING TRAIN/VALIDATION SPLIT
================================================================================
Total sequences: 8,151
‚úì Train sequences: 6,520 (80%)
‚úì Validation sequences: 1,631 (20%)

  Gesture distribution in splits:
  ----------------------------------------------------------------------------
  Above ear - pull hair                        : Train= 510 ( 79.9%) | Val= 128 ( 20.1%)
  Cheek - pinch skin                           : Train= 509 ( 79.9%) | Val= 128 ( 20.1%)
  Drink from bottle/cup                        : Train= 129 ( 80.1%) | Val=  32 ( 19.9%)
  Eyebrow - pull hair                          : Train= 510 ( 79.9%) | Val= 128 ( 20.1%)
  Eyelash - pull hair                          : Train= 512 ( 80.0%) | Val= 128 ( 20.0%)
  Feel around in tray and pull out an object   : Train= 129 ( 80.1%) | Val=  32 ( 19.9%)
  Forehead - pull hairline                     : Train= 512 ( 80.0%) | Val= 128 ( 20.0%)
  Forehead - scratch                           : Train= 512 ( 80.0%) | Val= 128 ( 20.0%)
  Glasses on/off                               : Train= 129 ( 80.1%) | Val=  32 ( 19.9%)
  Neck - pinch skin                            : Train= 512 ( 80.0%) | Val= 128 ( 20.0%)
  Neck - scratch                               : Train= 512 ( 80.0%) | Val= 128 ( 20.0%)
  Pinch knee/leg skin                          : Train= 129 ( 80.1%) | Val=  32 ( 19.9%)
  Pull air toward your face                    : Train= 381 ( 79.9%) | Val=  96 ( 20.1%)
  Scratch knee/leg skin                        : Train= 129 ( 80.1%) | Val=  32 ( 19.9%)
  Text on phone                                : Train= 512 ( 80.0%) | Val= 128 ( 20.0%)
  Wave hello                                   : Train= 382 ( 79.9%) | Val=  96 ( 20.1%)
  Write name in air                            : Train= 382 ( 80.1%) | Val=  95 ( 19.9%)
  Write name on leg                            : Train= 129 ( 80.1%) | Val=  32 ( 19.9%)

================================================================================
STEP 3: FEATURE EXTRACTION
================================================================================

Train data: 457,938 rows across 6,520 sequences
Validation data: 117,007 rows across 1,631 sequences

[3.1] Extracting IMU-only features (TIER 0)...
  Processing training set...
Processing 6520 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
  Processed 1700 sequences...
  Processed 1800 sequences...
  Processed 1900 sequences...
  Processed 2000 sequences...
  Processed 2100 sequences...
  Processed 2200 sequences...
  Processed 2300 sequences...
  Processed 2400 sequences...
  Processed 2500 sequences...
  Processed 2600 sequences...
  Processed 2700 sequences...
  Processed 2800 sequences...
  Processed 2900 sequences...
  Processed 3000 sequences...
  Processed 3100 sequences...
  Processed 3200 sequences...
  Processed 3300 sequences...
  Processed 3400 sequences...
  Processed 3500 sequences...
  Processed 3600 sequences...
  Processed 3700 sequences...
  Processed 3800 sequences...
  Processed 3900 sequences...
  Processed 4000 sequences...
  Processed 4100 sequences...
  Processed 4200 sequences...
  Processed 4300 sequences...
  Processed 4400 sequences...
  Processed 4500 sequences...
  Processed 4600 sequences...
  Processed 4700 sequences...
  Processed 4800 sequences...
  Processed 4900 sequences...
  Processed 5000 sequences...
  Processed 5100 sequences...
  Processed 5200 sequences...
  Processed 5300 sequences...
  Processed 5400 sequences...
  Processed 5500 sequences...
  Processed 5600 sequences...
  Processed 5700 sequences...
  Processed 5800 sequences...
  Processed 5900 sequences...
  Processed 6000 sequences...
  Processed 6100 sequences...
  Processed 6200 sequences...
  Processed 6300 sequences...
  Processed 6400 sequences...
  Processed 6500 sequences...
‚úì Feature extraction complete: (6520, 86)
  Total features: 85
  Processing validation set...
Processing 1631 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
‚úì Feature extraction complete: (1631, 86)
  Total features: 85
‚úì IMU-only features: 83 features

[3.2] Extracting full sensor features (TIER 0 + TIER 1)...
  Processing training set...
Processing 6520 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
  Processed 1700 sequences...
  Processed 1800 sequences...
  Processed 1900 sequences...
  Processed 2000 sequences...
  Processed 2100 sequences...
  Processed 2200 sequences...
  Processed 2300 sequences...
  Processed 2400 sequences...
  Processed 2500 sequences...
  Processed 2600 sequences...
  Processed 2700 sequences...
  Processed 2800 sequences...
  Processed 2900 sequences...
  Processed 3000 sequences...
  Processed 3100 sequences...
  Processed 3200 sequences...
  Processed 3300 sequences...
  Processed 3400 sequences...
  Processed 3500 sequences...
  Processed 3600 sequences...
  Processed 3700 sequences...
  Processed 3800 sequences...
  Processed 3900 sequences...
  Processed 4000 sequences...
  Processed 4100 sequences...
  Processed 4200 sequences...
  Processed 4300 sequences...
  Processed 4400 sequences...
  Processed 4500 sequences...
  Processed 4600 sequences...
  Processed 4700 sequences...
  Processed 4800 sequences...
  Processed 4900 sequences...
  Processed 5000 sequences...
  Processed 5100 sequences...
  Processed 5200 sequences...
  Processed 5300 sequences...
  Processed 5400 sequences...
  Processed 5500 sequences...
  Processed 5600 sequences...
  Processed 5700 sequences...
  Processed 5800 sequences...
  Processed 5900 sequences...
  Processed 6000 sequences...
  Processed 6100 sequences...
  Processed 6200 sequences...
  Processed 6300 sequences...
  Processed 6400 sequences...
  Processed 6500 sequences...
‚úì Feature extraction complete: (6520, 161)
  Total features: 160
  Processing validation set...
Processing 1631 sequences...
  Processed 100 sequences...
  Processed 200 sequences...
  Processed 300 sequences...
  Processed 400 sequences...
  Processed 500 sequences...
  Processed 600 sequences...
  Processed 700 sequences...
  Processed 800 sequences...
  Processed 900 sequences...
  Processed 1000 sequences...
  Processed 1100 sequences...
  Processed 1200 sequences...
  Processed 1300 sequences...
  Processed 1400 sequences...
  Processed 1500 sequences...
  Processed 1600 sequences...
‚úì Feature extraction complete: (1631, 161)
  Total features: 160
‚úì Full sensor features: 158 features

================================================================================
STEP 4: SIMULATING TEST CONDITIONS
================================================================================
‚úì Total validation sequences: 1631
  - IMU-only sequences (simulated): 815 (50.0%)
  - Full sensor sequences: 816 (50.0%)

================================================================================
STEP 5: PREPARING DATA FOR TRAINING
================================================================================
‚úì IMU-only data prepared:
  Train: (6520, 83)
  Val: (1631, 83)

‚úì Full sensor data prepared:
  Train: (6520, 158)
  Val: (1631, 158)

================================================================================
STEP 6: TRAINING MODELS
================================================================================

[6.1] Training IMU-only XGBoost model...

Training IMU-only XGBoost...
‚úì IMU-only XGBoost trained successfully
  Training samples: 6,520
  Validation samples: 1,631
  Features: 83

[6.2] Training Full sensor XGBoost model...

Training Full Sensor XGBoost...
‚úì Full Sensor XGBoost trained successfully
  Training samples: 6,520
  Validation samples: 1,631
  Features: 158

================================================================================
STEP 7: MODEL EVALUATION
================================================================================

[7.1] IMU-only Model Performance
================================================================================

  Evaluating on All Validation set:
  ----------------------------------------------------------------------------
  Competition Score: 0.6861
    - Binary F1 (BFRB vs. non-BFRB): 0.9541
    - Macro F1 (9 classes): 0.4181

  Per-Gesture F1 Scores:
  ----------------------------------------------------------------------------
  ‚ö†Ô∏è Eyebrow - pull hair                          : 0.1743
  ‚ö†Ô∏è Cheek - pinch skin                           : 0.2591
  ‚ö†Ô∏è Write name on leg                            : 0.2951
  ‚ö†Ô∏è Neck - pinch skin                            : 0.3267
  ‚ö†Ô∏è Forehead - pull hairline                     : 0.3359
  ‚ö†Ô∏è Neck - scratch                               : 0.3564
  ‚ö†Ô∏è Scratch knee/leg skin                        : 0.4068
  ‚ö†Ô∏è Eyelash - pull hair                          : 0.4085
  ‚ö†Ô∏è Pinch knee/leg skin                          : 0.4444
  ‚ö†Ô∏è Forehead - scratch                           : 0.4819
  ‚ö†Ô∏è Above ear - pull hair                        : 0.4980
  ‚úì Write name in air                            : 0.6458
  ‚úì Feel around in tray and pull out an object   : 0.7143
  ‚úì Pull air toward your face                    : 0.7345
  ‚úì Glasses on/off                               : 0.7397
  ‚úì Drink from bottle/cup                        : 0.7692
  ‚úì Wave hello                                   : 0.7716
  ‚úì Text on phone                                : 0.8638

  Overall Accuracy: 0.4850

  Evaluating on IMU-only Validation Subset set:
  ----------------------------------------------------------------------------
  Competition Score: 0.6864
    - Binary F1 (BFRB vs. non-BFRB): 0.9481
    - Macro F1 (9 classes): 0.4247

  Per-Gesture F1 Scores:
  ----------------------------------------------------------------------------
  ‚ö†Ô∏è Eyebrow - pull hair                          : 0.2185
  ‚ö†Ô∏è Write name on leg                            : 0.2222
  ‚ö†Ô∏è Cheek - pinch skin                           : 0.2373
  ‚ö†Ô∏è Forehead - pull hairline                     : 0.3485
  ‚ö†Ô∏è Neck - scratch                               : 0.3490
  ‚ö†Ô∏è Neck - pinch skin                            : 0.3636
  ‚ö†Ô∏è Pinch knee/leg skin                          : 0.4138
  ‚ö†Ô∏è Forehead - scratch                           : 0.4274
  ‚ö†Ô∏è Eyelash - pull hair                          : 0.4286
  ‚úì Above ear - pull hair                        : 0.5414
  ‚úì Scratch knee/leg skin                        : 0.5806
  ‚úì Write name in air                            : 0.6061
  ‚úì Glasses on/off                               : 0.6207
  ‚úì Feel around in tray and pull out an object   : 0.6875
  ‚úì Wave hello                                   : 0.7500
  ‚úì Drink from bottle/cup                        : 0.7619
  ‚úì Pull air toward your face                    : 0.7640
  ‚úì Text on phone                                : 0.8065

  Overall Accuracy: 0.4810

[7.2] Full Sensor Model Performance
================================================================================

  Evaluating on All Validation set:
  ----------------------------------------------------------------------------
  Competition Score: 0.7829
    - Binary F1 (BFRB vs. non-BFRB): 0.9747
    - Macro F1 (9 classes): 0.5910

  Per-Gesture F1 Scores:
  ----------------------------------------------------------------------------
  ‚ö†Ô∏è Eyebrow - pull hair                          : 0.3307
  ‚ö†Ô∏è Pinch knee/leg skin                          : 0.4138
  ‚ö†Ô∏è Neck - pinch skin                            : 0.4160
  ‚ö†Ô∏è Scratch knee/leg skin                        : 0.4444
  ‚ö†Ô∏è Eyelash - pull hair                          : 0.4835
  ‚úì Write name on leg                            : 0.5000
  ‚úì Cheek - pinch skin                           : 0.5134
  ‚úì Neck - scratch                               : 0.5348
  ‚úì Forehead - pull hairline                     : 0.6506
  ‚úì Write name in air                            : 0.6984
  ‚úì Forehead - scratch                           : 0.7115
  ‚úì Pull air toward your face                    : 0.7174
  ‚úì Above ear - pull hair                        : 0.7220
  ‚úì Wave hello                                   : 0.7755
  ‚úì Drink from bottle/cup                        : 0.8254
  ‚úì Glasses on/off                               : 0.8615
  ‚úì Feel around in tray and pull out an object   : 0.8852
  ‚úì Text on phone                                : 0.9195

  Overall Accuracy: 0.6193

  Evaluating on Full Sensor Validation Subset set:
  ----------------------------------------------------------------------------
  Competition Score: 0.7838
    - Binary F1 (BFRB vs. non-BFRB): 0.9762
    - Macro F1 (9 classes): 0.5913

  Per-Gesture F1 Scores:
  ----------------------------------------------------------------------------
  ‚ö†Ô∏è Scratch knee/leg skin                        : 0.2222
  ‚ö†Ô∏è Eyebrow - pull hair                          : 0.3308
  ‚ö†Ô∏è Pinch knee/leg skin                          : 0.4242
  ‚ö†Ô∏è Neck - pinch skin                            : 0.4355
  ‚ö†Ô∏è Eyelash - pull hair                          : 0.4615
  ‚úì Cheek - pinch skin                           : 0.5116
  ‚úì Write name on leg                            : 0.5238
  ‚úì Neck - scratch                               : 0.5323
  ‚úì Forehead - pull hairline                     : 0.6607
  ‚úì Above ear - pull hair                        : 0.6726
  ‚úì Pull air toward your face                    : 0.7253
  ‚úì Write name in air                            : 0.7253
  ‚úì Forehead - scratch                           : 0.7552
  ‚úì Drink from bottle/cup                        : 0.8182
  ‚úì Wave hello                                   : 0.8421
  ‚úì Feel around in tray and pull out an object   : 0.9032
  ‚úì Glasses on/off                               : 0.9231
  ‚úì Text on phone                                : 0.9403

  Overall Accuracy: 0.6287

================================================================================
STEP 8: SIMULATED COMPETITION PERFORMANCE
================================================================================

  Simulated Test Set Performance (50% IMU + 50% Full):
  ============================================================================
  IMU-only Model (50% of test): 0.6864
  Full Sensor Model (50% of test): 0.7838
  Overall Simulated Score: 0.7351

  Value Added by ToF + Thermal:
  ============================================================================
  Absolute improvement: +0.0973
  Relative improvement: +14.2%

================================================================================
STEP 9: SAVING MODELS
================================================================================
‚úì IMU-only model saved: models/xgboost_imu_only.pkl
‚úì Full sensor model saved: models/xgboost_full_sensor.pkl

================================================================================
TRAINING COMPLETE!
================================================================================

üìä Final Results:
  IMU-only Model Score: 0.6864
  Full Sensor Model Score: 0.7838
  Overall Competition Score (simulated): 0.7351

‚úÖ Models saved to 'models/' directory
================================================================================
